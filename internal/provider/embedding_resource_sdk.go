// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package provider

import (
	"encoding/json"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"math/big"
	"openai/internal/sdk/pkg/models/shared"
)

func (r *EmbeddingResourceModel) ToCreateSDKType() *shared.CreateEmbeddingRequest {
	var input shared.CreateEmbeddingRequestInput
	str := new(string)
	if !r.Input.Str.IsUnknown() && !r.Input.Str.IsNull() {
		*str = r.Input.Str.ValueString()
	} else {
		str = nil
	}
	if str != nil {
		input = shared.CreateEmbeddingRequestInput{
			Str: str,
		}
	}
	var arrayOfstr []string = nil
	for _, arrayOfstrItem := range r.Input.ArrayOfstr {
		arrayOfstr = append(arrayOfstr, arrayOfstrItem.ValueString())
	}
	if arrayOfstr != nil {
		input = shared.CreateEmbeddingRequestInput{
			ArrayOfstr: arrayOfstr,
		}
	}
	var arrayOfinteger []int64 = nil
	for _, arrayOfintegerItem := range r.Input.ArrayOfinteger {
		arrayOfinteger = append(arrayOfinteger, arrayOfintegerItem.ValueInt64())
	}
	if arrayOfinteger != nil {
		input = shared.CreateEmbeddingRequestInput{
			ArrayOfinteger: arrayOfinteger,
		}
	}
	var arrayOfarrayOfinteger [][]int64 = nil
	for _, arrayOfarrayOfintegerItem := range r.Input.ArrayOfarrayOfinteger {
		var arrayOfarrayOfintegerTmp []int64 = nil
		for _, item := range arrayOfarrayOfintegerItem {
			arrayOfarrayOfintegerTmp = append(arrayOfarrayOfintegerTmp, item.ValueInt64())
		}
		arrayOfarrayOfinteger = append(arrayOfarrayOfinteger, arrayOfarrayOfintegerTmp)
	}
	if arrayOfarrayOfinteger != nil {
		input = shared.CreateEmbeddingRequestInput{
			ArrayOfarrayOfinteger: arrayOfarrayOfinteger,
		}
	}
	model := shared.CreateEmbeddingRequestModel(r.Model.ValueString())
	user := new(string)
	if !r.User.IsUnknown() && !r.User.IsNull() {
		*user = r.User.ValueString()
	} else {
		user = nil
	}
	var additionalProperties interface{}
	if !r.AdditionalProperties.IsUnknown() && !r.AdditionalProperties.IsNull() {
		_ = json.Unmarshal([]byte(r.AdditionalProperties.ValueString()), &additionalProperties)
	}
	out := shared.CreateEmbeddingRequest{
		Input:                input,
		Model:                model,
		User:                 user,
		AdditionalProperties: additionalProperties,
	}
	return &out
}

func (r *EmbeddingResourceModel) RefreshFromCreateResponse(resp *shared.CreateEmbeddingResponse) {
	r.Data = nil
	for _, dataItem := range resp.Data {
		var data1 CreateEmbeddingResponseData
		data1.Embedding = nil
		for _, v := range dataItem.Embedding {
			data1.Embedding = append(data1.Embedding, types.NumberValue(big.NewFloat(float64(v))))
		}
		data1.Index = types.Int64Value(dataItem.Index)
		data1.Object = types.StringValue(dataItem.Object)
		r.Data = append(r.Data, data1)
	}
	r.Object = types.StringValue(resp.Object)
	r.Usage.PromptTokens = types.Int64Value(resp.Usage.PromptTokens)
	r.Usage.TotalTokens = types.Int64Value(resp.Usage.TotalTokens)
}
